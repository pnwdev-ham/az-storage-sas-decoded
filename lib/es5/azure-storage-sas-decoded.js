"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var service_sas_decode_1=require("./sasTypes/service-sas-decode"),sas_decoded_result_1=require("./results/sas-decoded-result"),AzureStorageSasDecoded=function(){function s(){}return s.getSasType=function(e){return e?.ss?sas_decoded_result_1.SasTypeEnum.Account:e?.sks?sas_decoded_result_1.SasTypeEnum.UserDelegation:e?.sr?sas_decoded_result_1.SasTypeEnum.Service:sas_decoded_result_1.SasTypeEnum.Unexpected},s.decodeSasToken=function(e,t){var r={IncomingData:{SasToken:e},MetaData:{CorrectFormat:!1,DidDecode:!1,PermissionsInOrder:!1},ResultData:{SasType:sas_decoded_result_1.SasTypeEnum.Unknown,Options:t,SasDecoded:[],Properties:null},Errors:[]};return!e||!t||Object.keys(t).length===0?(e||r.Errors.push({message:"sasToken is empty",function:"AzureStorageSasDecoded::decodeSasToken"}),t||r.Errors.push({message:"sasTokenOptions is empty",function:"AzureStorageSasDecoded::decodeSasToken"}),Object.keys(t).length===0&&r.Errors.push({message:"sasTokenOptions has no keys",function:"AzureStorageSasDecoded::decodeSasToken"}),r):(r.ResultData.SasType=s.getSasType(t),r.ResultData.SasType===sas_decoded_result_1.SasTypeEnum.Service&&(r.MetaData.PermissionsInOrder=(0,service_sas_decode_1.arePermissionsInOrder)(t.sp),r.MetaData.PermissionsInOrder||(r.MetaData.CorrectFormat=!1)),r.ResultData.Properties=(0,service_sas_decode_1.decodeServiceTokenQueryString)(t),r.MetaData.CorrectFormat=!0,r.MetaData.DidDecode=!0,r)},s}();exports.default=AzureStorageSasDecoded;